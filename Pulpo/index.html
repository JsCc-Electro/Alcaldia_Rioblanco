<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modelo Pulpo: Estudio de Factibilidad</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <!-- Styles & Chart Container Constraints -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F9FA; /* Warm neutral background */
            color: #1F2937;
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Custom Scrollbar for text areas */
        .custom-scroll::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scroll::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background: #CBD5E1; 
            border-radius: 4px;
        }
        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background: #94A3B8; 
        }

        .phase-card {
            transition: all 0.3s ease;
        }
        .phase-card.active {
            border-left: 4px solid #0F766E; /* Teal-700 */
            background-color: #FFFFFF;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
    </style>

    <!-- Chosen Palette: Warm Neutrals (Slate/Stone) with Teal and Amber accents for data -->
    <!-- Application Structure Plan:
         1. Hero Section: Introduction to the "Modelo Pulpo".
         2. Interactive Architecture (The Logic): A 4-step interactive flow to explain the technical core (Ingest, Analysis, Assign, Validate). Users click phases to see tech specs.
         3. ROI Simulator: Input slider for 'Monthly Petitions' -> Updates Charts (Time Savings & Paper Savings). Demonstrates the 'Plan de Reducci√≥n'.
         4. Legal Framework: Interactive cards explaining compliance with Colombian Law (Ley 527, Zero Paper).
         5. Roadmap: A timeline visualization for the 3-phase implementation plan.
         Rationale: This structure moves from Concept -> Mechanics -> Value (ROI) -> Feasibility (Legal) -> Execution, logically answering "What is it?", "How does it work?", "Is it worth it?", "Is it legal?", and "How do we start?".
    -->
    <!-- Visualization & Content Choices:
         - Tech Architecture -> Interactive List/Cards -> JS Class Toggling -> To simplify complex tech stack into digestible steps.
         - ROI Data -> Chart.js Bar & Doughnut -> Dynamic JS updates based on Slider -> To visualize the massive efficiency gap between Manual vs. AI.
         - Roadmap -> Vertical HTML Timeline -> CSS/Flexbox -> Linearity fits the "Phased" approach perfectly.
         - NO SVG/Mermaid confirmed.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="text-slate-800">

    <!-- Navigation / Header -->
    <nav class="bg-white border-b border-slate-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl mr-2">üêô</span>
                    <h1 class="text-xl font-bold text-slate-900 tracking-tight">Modelo Pulpo <span class="text-teal-600 font-normal">| Estudio de Factibilidad</span></h1>
                </div>
                <div class="hidden md:flex space-x-8 items-center text-sm font-medium text-slate-500">
                    <a href="#arquitectura" class="hover:text-teal-600 transition-colors">Arquitectura</a>
                    <a href="#roi" class="hover:text-teal-600 transition-colors">Simulador ROI</a>
                    <a href="#legal" class="hover:text-teal-600 transition-colors">Legal</a>
                    <a href="#roadmap" class="hover:text-teal-600 transition-colors">Hoja de Ruta</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 space-y-16">

        <!-- Section 1: Introduction -->
        <section class="text-center max-w-3xl mx-auto">
            <h2 class="text-4xl font-extrabold text-slate-900 mb-4">Orquestaci√≥n Inteligente para la Gesti√≥n P√∫blica</h2>
            <p class="text-lg text-slate-600 leading-relaxed">
                Este estudio presenta la factibilidad t√©cnica, legal y operativa para implementar un sistema centralizado de IA en una alcald√≠a municipal colombiana. 
                El objetivo es transformar la ventanilla √∫nica en un <strong>cerebro digital</strong> capaz de gestionar peticiones ciudadanas con autonom√≠a supervisada.
            </p>
        </section>

        <!-- Section 2: Technical Architecture (The Octopus Logic) -->
        <section id="arquitectura" class="bg-slate-100 rounded-2xl p-6 md:p-10">
            <div class="mb-8">
                <h3 class="text-2xl font-bold text-slate-900">1. Arquitectura T√©cnica: El Flujo de Datos</h3>
                <p class="text-slate-600 mt-2">
                    El "Modelo Pulpo" opera en cuatro fases cr√≠ticas. Haga clic en cada fase para explorar el stack tecnol√≥gico (Open Source/H√≠brido) y los modelos de IA propuestos.
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                <!-- Navigation / Phases -->
                <div class="lg:col-span-5 space-y-4">
                    <button onclick="updateArch('ingesta')" id="btn-ingesta" class="phase-card active w-full text-left p-5 rounded-xl border border-slate-200 hover:border-teal-400 focus:outline-none bg-white">
                        <div class="flex items-center justify-between">
                            <h4 class="font-bold text-lg text-slate-800">1. La Cabeza (Ingesta)</h4>
                            <span class="text-2xl">üì•</span>
                        </div>
                        <p class="text-sm text-slate-500 mt-1">Recepci√≥n omnicanal unificada.</p>
                    </button>

                    <button onclick="updateArch('analisis')" id="btn-analisis" class="phase-card w-full text-left p-5 rounded-xl border border-slate-200 hover:border-teal-400 focus:outline-none bg-slate-50">
                        <div class="flex items-center justify-between">
                            <h4 class="font-bold text-lg text-slate-800">2. El Cerebro (An√°lisis)</h4>
                            <span class="text-2xl">üß†</span>
                        </div>
                        <p class="text-sm text-slate-500 mt-1">NLP, OCR y extracci√≥n de datos.</p>
                    </button>

                    <button onclick="updateArch('asignacion')" id="btn-asignacion" class="phase-card w-full text-left p-5 rounded-xl border border-slate-200 hover:border-teal-400 focus:outline-none bg-slate-50">
                        <div class="flex items-center justify-between">
                            <h4 class="font-bold text-lg text-slate-800">3. Los Tent√°culos (Asignaci√≥n)</h4>
                            <span class="text-2xl">ü¶ë</span>
                        </div>
                        <p class="text-sm text-slate-500 mt-1">Enrutamiento sem√°ntico a dependencias.</p>
                    </button>

                    <button onclick="updateArch('validacion')" id="btn-validacion" class="phase-card w-full text-left p-5 rounded-xl border border-slate-200 hover:border-teal-400 focus:outline-none bg-slate-50">
                        <div class="flex items-center justify-between">
                            <h4 class="font-bold text-lg text-slate-800">4. Cierre (Validaci√≥n)</h4>
                            <span class="text-2xl">‚úÖ</span>
                        </div>
                        <p class="text-sm text-slate-500 mt-1">Human-in-the-loop y respuesta.</p>
                    </button>
                </div>

                <!-- Detail View -->
                <div class="lg:col-span-7 bg-white rounded-xl shadow-sm border border-slate-200 p-8 flex flex-col justify-center">
                    <div id="arch-content">
                        <!-- Content injected via JS -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: ROI Simulator -->
        <section id="roi">
            <div class="mb-6">
                <h3 class="text-2xl font-bold text-slate-900">3. Simulador de ROI y Reducci√≥n de Recursos</h3>
                <p class="text-slate-600 mt-2">
                    Ajuste el volumen mensual de peticiones para proyectar el ahorro en tiempo y recursos. El modelo transforma al funcionario de "radicador manual" a "auditor de calidad".
                </p>
            </div>

            <div class="bg-white border border-slate-200 rounded-2xl p-6 md:p-8 shadow-sm">
                <!-- Controls -->
                <div class="mb-8">
                    <label for="volumeSlider" class="block text-sm font-medium text-slate-700 mb-2">
                        Peticiones Mensuales (PQRSD): <span id="volumeValue" class="text-teal-700 font-bold text-lg">1000</span>
                    </label>
                    <input type="range" id="volumeSlider" min="100" max="5000" step="100" value="1000" 
                           class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-teal-600">
                    <div class="flex justify-between text-xs text-slate-400 mt-1">
                        <span>100</span>
                        <span>5000</span>
                    </div>
                </div>

                <!-- KPI Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                    <div class="bg-slate-50 p-4 rounded-lg border border-slate-100 text-center">
                        <p class="text-xs text-slate-500 uppercase tracking-wide">Ahorro Tiempo (Mensual)</p>
                        <p id="timeSaved" class="text-2xl font-bold text-teal-600">466 Horas</p>
                        <p class="text-xs text-slate-400">vs. Proceso Manual</p>
                    </div>
                    <div class="bg-slate-50 p-4 rounded-lg border border-slate-100 text-center">
                        <p class="text-xs text-slate-500 uppercase tracking-wide">Papel Ahorrado</p>
                        <p id="paperSaved" class="text-2xl font-bold text-amber-600">3,000 Hojas</p>
                        <p class="text-xs text-slate-400">Est. 3 hojas/tr√°mite</p>
                    </div>
                    <div class="bg-slate-50 p-4 rounded-lg border border-slate-100 text-center">
                        <p class="text-xs text-slate-500 uppercase tracking-wide">Eficiencia Operativa</p>
                        <p class="text-2xl font-bold text-slate-700">93%</p>
                        <p class="text-xs text-slate-400">Reducci√≥n tiempos de ciclo</p>
                    </div>
                </div>

                <!-- Charts Area -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                    <div>
                        <h4 class="text-sm font-semibold text-slate-700 mb-4 text-center">Comparativa: Tiempo de Procesamiento (Minutos/Tr√°mite)</h4>
                        <div class="chart-container">
                            <canvas id="timeChart"></canvas>
                        </div>
                    </div>
                    <div>
                        <h4 class="text-sm font-semibold text-slate-700 mb-4 text-center">Transformaci√≥n del Rol del Funcionario</h4>
                        <div class="chart-container">
                            <canvas id="roleChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Legal Framework -->
        <section id="legal" class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div>
                <h3 class="text-2xl font-bold text-slate-900 mb-4">2. Cumplimiento Normativo</h3>
                <p class="text-slate-600 mb-6">
                    El dise√±o del modelo garantiza la plena validez jur√≠dica en el contexto colombiano, aline√°ndose con las directivas de gobierno digital.
                </p>
                
                <div class="space-y-4">
                    <!-- Accordion Item 1 -->
                    <div class="border border-slate-200 rounded-lg overflow-hidden">
                        <button onclick="toggleLegal('l1')" class="w-full px-5 py-4 text-left bg-slate-50 hover:bg-slate-100 flex justify-between items-center transition">
                            <span class="font-semibold text-slate-800">Ley 527 de 1999</span>
                            <span class="text-xs bg-teal-100 text-teal-800 px-2 py-1 rounded">Validez Jur√≠dica</span>
                        </button>
                        <div id="l1" class="hidden px-5 py-4 bg-white text-sm text-slate-600 border-t border-slate-100">
                            Garantiza que los mensajes de datos procesados por la IA tienen la misma fuerza probatoria que el papel. El sistema implementa estampas cronol√≥gicas certificadas para asegurar el "no repudio".
                        </div>
                    </div>

                    <!-- Accordion Item 2 -->
                    <div class="border border-slate-200 rounded-lg overflow-hidden">
                        <button onclick="toggleLegal('l2')" class="w-full px-5 py-4 text-left bg-slate-50 hover:bg-slate-100 flex justify-between items-center transition">
                            <span class="font-semibold text-slate-800">Directiva Cero Papel</span>
                            <span class="text-xs bg-teal-100 text-teal-800 px-2 py-1 rounded">Eficiencia</span>
                        </button>
                        <div id="l2" class="hidden px-5 py-4 bg-white text-sm text-slate-600 border-t border-slate-100">
                            Alineaci√≥n total con la directiva presidencial. El modelo prioriza el "Digital First", digitalizando en la fuente (ventanilla f√≠sica con esc√°ner OCR) y eliminando copias f√≠sicas internas.
                        </div>
                    </div>

                    <!-- Accordion Item 3 -->
                    <div class="border border-slate-200 rounded-lg overflow-hidden">
                        <button onclick="toggleLegal('l3')" class="w-full px-5 py-4 text-left bg-slate-50 hover:bg-slate-100 flex justify-between items-center transition">
                            <span class="font-semibold text-slate-800">MGDEA / Archivo General</span>
                            <span class="text-xs bg-teal-100 text-teal-800 px-2 py-1 rounded">Gesti√≥n Documental</span>
                        </button>
                        <div id="l3" class="hidden px-5 py-4 bg-white text-sm text-slate-600 border-t border-slate-100">
                            El sistema genera metadatos autom√°ticos compatibles con el Cuadro de Clasificaci√≥n Documental (CCD) y Tablas de Retenci√≥n (TRD), facilitando el archivo electr√≥nico a largo plazo.
                        </div>
                    </div>
                     <!-- Accordion Item 4 -->
                     <div class="border border-slate-200 rounded-lg overflow-hidden">
                        <button onclick="toggleLegal('l4')" class="w-full px-5 py-4 text-left bg-slate-50 hover:bg-slate-100 flex justify-between items-center transition">
                            <span class="font-semibold text-slate-800">Habeas Data & Privacidad</span>
                            <span class="text-xs bg-amber-100 text-amber-800 px-2 py-1 rounded">Protecci√≥n Datos</span>
                        </button>
                        <div id="l4" class="hidden px-5 py-4 bg-white text-sm text-slate-600 border-t border-slate-100">
                            La IA se entrena con datos anonimizados. En producci√≥n, el flujo de datos es encriptado (TLS 1.3). El sistema clasifica autom√°ticamente documentos con datos sensibles para restringir su acceso solo a funcionarios autorizados.
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-slate-50 rounded-2xl p-6 border border-slate-200 flex flex-col justify-center items-center text-center">
                <div class="w-16 h-16 bg-white rounded-full flex items-center justify-center shadow-sm text-3xl mb-4">‚öñÔ∏è</div>
                <h4 class="font-bold text-slate-800 text-lg mb-2">Seguridad Jur√≠dica</h4>
                <p class="text-slate-600 text-sm px-4">
                    "El modelo no reemplaza la responsabilidad del funcionario, sino que la potencia. La decisi√≥n final administrativa (acto administrativo) siempre es validada por un humano, cumpliendo con el principio de reserva legal."
                </p>
            </div>
        </section>

        <!-- Section 5: Implementation Roadmap -->
        <section id="roadmap">
            <div class="mb-10 text-center">
                <h3 class="text-2xl font-bold text-slate-900">4. Hoja de Ruta de Implementaci√≥n</h3>
                <p class="text-slate-600">Ejecuci√≥n faseada para mitigar riesgos y ajustar el presupuesto.</p>
            </div>

            <div class="relative max-w-4xl mx-auto">
                <!-- Vertical Line -->
                <div class="absolute left-4 md:left-1/2 top-0 bottom-0 w-0.5 bg-slate-200 -ml-px"></div>

                <!-- Phase 1 -->
                <div class="relative mb-12">
                    <div class="flex flex-col md:flex-row items-center w-full">
                        <div class="order-1 md:w-1/2 md:pr-8 text-left md:text-right mb-4 md:mb-0">
                            <h4 class="text-lg font-bold text-teal-700">Fase 1: Piloto PQR</h4>
                            <p class="text-slate-600 text-sm mt-1">Implementaci√≥n acotada a Peticiones, Quejas y Reclamos simples. Entrenamiento del modelo con hist√≥rico de 6 meses.</p>
                            <span class="inline-block mt-2 px-2 py-1 bg-slate-100 text-slate-600 text-xs rounded border border-slate-200">Meses 1-3</span>
                        </div>
                        <div class="order-2 absolute left-4 md:left-1/2 w-8 h-8 bg-teal-500 rounded-full border-4 border-white shadow transform -translate-x-1/2 flex items-center justify-center text-white text-xs font-bold">1</div>
                        <div class="order-3 md:w-1/2 md:pl-8">
                            <ul class="text-sm text-slate-500 list-disc list-inside">
                                <li>Configuraci√≥n Tesseract (OCR).</li>
                                <li>Despliegue modelo clasificaci√≥n simple.</li>
                                <li>Validaci√≥n humana al 100%.</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Phase 2 -->
                <div class="relative mb-12">
                    <div class="flex flex-col md:flex-row items-center w-full">
                        <div class="order-1 md:w-1/2 md:pr-8 text-left md:text-right mb-4 md:mb-0 md:order-3">
                            <h4 class="text-lg font-bold text-teal-700">Fase 2: Expansi√≥n Transaccional</h4>
                            <p class="text-slate-600 text-sm mt-1">Inclusi√≥n de tr√°mites complejos: Impuesto Predial, Industria y Comercio, Licencias de Construcci√≥n.</p>
                            <span class="inline-block mt-2 px-2 py-1 bg-slate-100 text-slate-600 text-xs rounded border border-slate-200">Meses 4-9</span>
                        </div>
                        <div class="order-2 absolute left-4 md:left-1/2 w-8 h-8 bg-white border-2 border-teal-500 rounded-full transform -translate-x-1/2 flex items-center justify-center text-teal-700 text-xs font-bold">2</div>
                        <div class="order-3 md:w-1/2 md:pl-8 md:order-1 text-right md:text-left">
                             <ul class="text-sm text-slate-500 list-disc list-inside">
                                <li>Integraci√≥n con ERP Financiero.</li>
                                <li>Validaci√≥n de datos estructurados.</li>
                                <li>Respuesta autom√°tica a consultas de saldo.</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Phase 3 -->
                <div class="relative">
                    <div class="flex flex-col md:flex-row items-center w-full">
                        <div class="order-1 md:w-1/2 md:pr-8 text-left md:text-right mb-4 md:mb-0">
                            <h4 class="text-lg font-bold text-teal-700">Fase 3: Autonom√≠a Supervisada</h4>
                            <p class="text-slate-600 text-sm mt-1">El sistema redacta borradores de respuesta completos. El funcionario audita muestras aleatorias y casos cr√≠ticos.</p>
                            <span class="inline-block mt-2 px-2 py-1 bg-slate-100 text-slate-600 text-xs rounded border border-slate-200">Mes 10+</span>
                        </div>
                        <div class="order-2 absolute left-4 md:left-1/2 w-8 h-8 bg-white border-2 border-slate-300 rounded-full transform -translate-x-1/2 flex items-center justify-center text-slate-500 text-xs font-bold">3</div>
                        <div class="order-3 md:w-1/2 md:pl-8">
                             <ul class="text-sm text-slate-500 list-disc list-inside">
                                <li>Fine-tuning de GPT-4o mini con feedback local.</li>
                                <li>Reducci√≥n intervenci√≥n humana al 20%.</li>
                                <li>Tableros de control predictivos.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-slate-900 text-slate-400 py-8 mt-12">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="mb-2">¬© 2025 Estudio de Factibilidad - Modelo Pulpo</p>
            <p class="text-xs text-slate-500">Documento interno para toma de decisiones estrat√©gicas en transformaci√≥n digital gubernamental.</p>
        </div>
    </footer>

    <script>
        // --- Data & State Management ---
        
        // Architecture Details Data
        const archData = {
            ingesta: {
                title: "La Cabeza: Ingesta Omnicanal",
                icon: "üì•",
                desc: "Punto √∫nico de entrada que unifica canales f√≠sicos y digitales.",
                tech: [
                    { name: "OCR", tool: "Tesseract / AWS Textract", detail: "Digitalizaci√≥n de cartas f√≠sicas en ventanilla." },
                    { name: "Connectors", tool: "API Gateway", detail: "Webhooks para WhatsApp Business y Correo." },
                    { name: "Security", tool: "WAF & TLS 1.3", detail: "Protecci√≥n de entrada de datos." }
                ],
                flow: "Ciudadano env√≠a solicitud ‚ûî Sistema normaliza formato (PDF/Img a Texto) ‚ûî Generaci√≥n de Radicado √önico."
            },
            analisis: {
                title: "El Cerebro: An√°lisis Cognitivo",
                icon: "üß†",
                desc: "Comprensi√≥n del contenido no estructurado mediante Modelos de Lenguaje (LLMs).",
                tech: [
                    { name: "NLP Model", tool: "BERT (Multilingual) o GPT-4o mini", detail: "Clasificaci√≥n de intenci√≥n y extracci√≥n de entidades (Nombres, C√©dulas, Predios)." },
                    { name: "Validaci√≥n", tool: "RegEx Avanzado", detail: "Verificaci√≥n de formatos de documentos adjuntos." }
                ],
                flow: "Texto extra√≠do ‚ûî Detecci√≥n de tema (ej. 'Impuestos') ‚ûî Extracci√≥n de metadatos ‚ûî Clasificaci√≥n de urgencia."
            },
            asignacion: {
                title: "Los Tent√°culos: Asignaci√≥n Inteligente",
                icon: "ü¶ë",
                desc: "Enrutamiento autom√°tico a la dependencia competente sin intervenci√≥n humana.",
                tech: [
                    { name: "Routing Engine", tool: "Python / Camunda", detail: "Motor de reglas de negocio basado en la competencia sem√°ntica." },
                    { name: "Database", tool: "PostgreSQL", detail: "Registro de trazabilidad y auditor√≠a." }
                ],
                flow: "Sistema consulta organigrama ‚ûî Mapea tema con secretar√≠a (ej. 'Hueco en calle' ‚ûî Infraestructura) ‚ûî Asigna tarea en bandeja de entrada."
            },
            validacion: {
                title: "Cierre: Validaci√≥n y Respuesta",
                icon: "‚úÖ",
                desc: "Generaci√≥n de respuesta y control de calidad humano.",
                tech: [
                    { name: "Generaci√≥n", tool: "Template Engine + LLM", detail: "Redacci√≥n de borrador de respuesta basado en normativa." },
                    { name: "Notificaci√≥n", tool: "SMTP / SMS Gateway", detail: "Env√≠o de respuesta final firmada digitalmente." }
                ],
                flow: "IA sugiere respuesta ‚ûî Funcionario aprueba/edita (Human-in-the-loop) ‚ûî Firma Digital ‚ûî Notificaci√≥n al Ciudadano."
            }
        };

        // --- Interaction Logic: Architecture ---
        function updateArch(phase) {
            // Update Buttons UI
            document.querySelectorAll('.phase-card').forEach(btn => {
                btn.classList.remove('active', 'bg-white', 'border-l-4', 'border-teal-700');
                btn.classList.add('bg-slate-50');
            });
            const activeBtn = document.getElementById(`btn-${phase}`);
            activeBtn.classList.add('active');
            activeBtn.classList.remove('bg-slate-50');

            // Update Content
            const data = archData[phase];
            const contentDiv = document.getElementById('arch-content');
            
            let techList = data.tech.map(t => `
                <div class="flex items-start p-3 bg-slate-50 rounded border border-slate-100">
                    <div class="font-bold text-teal-700 text-xs uppercase w-20 flex-shrink-0">${t.name}</div>
                    <div>
                        <div class="font-semibold text-slate-800 text-sm">${t.tool}</div>
                        <div class="text-slate-500 text-xs">${t.detail}</div>
                    </div>
                </div>
            `).join('');

            contentDiv.innerHTML = `
                <div class="animate-fade-in">
                    <div class="flex items-center mb-4">
                        <span class="text-4xl mr-4">${data.icon}</span>
                        <h3 class="text-xl font-bold text-slate-800">${data.title}</h3>
                    </div>
                    <p class="text-slate-600 mb-6">${data.desc}</p>
                    
                    <h5 class="font-bold text-slate-900 text-sm mb-3 border-b border-slate-100 pb-1">Stack Tecnol√≥gico Recomendado</h5>
                    <div class="space-y-2 mb-6">
                        ${techList}
                    </div>

                    <h5 class="font-bold text-slate-900 text-sm mb-2 border-b border-slate-100 pb-1">Flujo L√≥gico</h5>
                    <div class="p-3 bg-teal-50 text-teal-900 rounded text-sm font-medium border border-teal-100">
                        ${data.flow}
                    </div>
                </div>
            `;
        }

        // --- Interaction Logic: Legal Accordion ---
        function toggleLegal(id) {
            const el = document.getElementById(id);
            if (el.classList.contains('hidden')) {
                el.classList.remove('hidden');
            } else {
                el.classList.add('hidden');
            }
        }

        // --- Logic: ROI Simulator & Charts ---
        let timeChart, roleChart;

        function initCharts() {
            // Chart 1: Time Comparison
            const ctxTime = document.getElementById('timeChart').getContext('2d');
            timeChart = new Chart(ctxTime, {
                type: 'bar',
                data: {
                    labels: ['Radicaci√≥n', 'Clasificaci√≥n', 'Respuesta'],
                    datasets: [
                        {
                            label: 'Proceso Manual (Min)',
                            data: [15, 20, 45],
                            backgroundColor: '#CBD5E1', // Slate 300
                            borderRadius: 4
                        },
                        {
                            label: 'Modelo Pulpo (Min)',
                            data: [2, 0.5, 10], // Much faster
                            backgroundColor: '#0D9488', // Teal 600
                            borderRadius: 4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: { mode: 'index', intersect: false }
                    },
                    scales: {
                        y: { beginAtZero: true, title: { display: true, text: 'Minutos' } }
                    }
                }
            });

            // Chart 2: Role Transformation (Donut)
            const ctxRole = document.getElementById('roleChart').getContext('2d');
            roleChart = new Chart(ctxRole, {
                type: 'doughnut',
                data: {
                    labels: ['Tareas Repetitivas', 'Auditor√≠a/Calidad', 'Atenci√≥n Humana'],
                    datasets: [{
                        data: [80, 5, 15], // Current State (Manual) - Initial render
                        backgroundColor: ['#ef4444', '#f59e0b', '#3b82f6'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        title: { display: true, text: 'Distribuci√≥n de Tiempo del Funcionario' }
                    }
                }
            });
        }

        function updateROI() {
            const volume = parseInt(document.getElementById('volumeSlider').value);
            document.getElementById('volumeValue').innerText = volume.toLocaleString();

            // Calculation Logic
            // Manual: Avg 30 mins (0.5 hr) per PQR total processing (reception to routing)
            // AI: Avg 2 mins (0.033 hr)
            const manualHours = volume * 0.5;
            const aiHours = volume * 0.033;
            const savedHours = Math.round(manualHours - aiHours);

            // Paper: Avg 3 sheets per PQR (Request + Annex + Copy)
            const savedPaper = (volume * 3).toLocaleString();

            // Update DOM text
            document.getElementById('timeSaved').innerText = `${savedHours} Horas`;
            document.getElementById('paperSaved').innerText = `${savedPaper} Hojas`;

            // Update Role Chart Data based on concept
            // As volume increases, the "Repetitive Tasks" segment should disappear in the AI model
            // But here we show the comparison of the NEW State vs OLD State conceptually
            // Let's toggle the chart data to represent the "Modelo Pulpo" distribution
            
            // For the visual interaction, let's keep the donut static representing the TARGET state
            // Or better, let's compare Manual vs AI allocation
            roleChart.data.datasets[0].data = [10, 50, 40]; // Target state: Low repetitive, High Quality control, High Human Touch
            roleChart.data.datasets[0].backgroundColor = ['#CBD5E1', '#F59E0B', '#0F766E']; // Grey, Amber, Teal
            roleChart.update();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            updateArch('ingesta'); // Load initial tab
            initCharts();
            updateROI(); // Initial calculation

            // Listener for Slider
            document.getElementById('volumeSlider').addEventListener('input', updateROI);
        });

    </script>
</body>
</html>
